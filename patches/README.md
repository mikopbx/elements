# Патчи для интернационализации внешних библиотек

Эта папка содержит патчи для поддержки i18n в сторонних библиотеках Stoplight Elements.

## @stoplight/json-schema-viewer v4.16.3

**Файл:** `@stoplight+json-schema-viewer+4.16.3.patch`

### Назначение
Добавляет поддержку интернационализации для свойств схем JSON и валидаций:
- `required` (обязательное поле)
- `read-only` (только для чтения)
- `Allowed value/Allowed values` (допустимое значение/допустимые значения)
- `Example/Examples` (пример/примеры)
- `Multiple of` (кратно)
- `Match pattern` (соответствует шаблону)
- `Default` (по умолчанию)
- `Style` (стиль)

### Изменения

#### 1. Модифицирует компонент `Properties`
В файлах `index.js` и `index.mjs`:
- Добавляет локальную функцию `t(key)` для перевода
- Оборачивает строки `required`, `read-only` в вызовы `t()`

#### 2. Модифицирует функцию `createValidationsFormatter`
В файлах `index.js` и `index.mjs`:
- Добавляет локальную функцию `t(key)` для перевода
- Создает `pluralMap` для правильной обработки множественного числа
- Изменяет логику генерации названий валидаций с поддержкой i18n
- Обновляет все ключи валидаций на i18n ключи с префиксом `sl_`

Функция `t(key)`:
1. Проверяет наличие глобальной функции `i18n()`
2. Вызывает `i18n(key)` если доступна
3. Возвращает ключ как есть, если i18n недоступна

### Применение патча

#### Автоматически (рекомендуется)
При использовании `patch-package`:
```bash
yarn add -D patch-package postinstall-postinstall
```

Добавьте в `package.json`:
```json
{
  "scripts": {
    "postinstall": "patch-package"
  }
}
```

#### Вручную
После установки зависимостей применить патч:
```bash
cd node_modules/@stoplight/json-schema-viewer
# Применить изменения вручную из patch файла
```

### Переводы
Используемые ключи переводов в MikoPBX:

**Свойства схемы:**
- `sl_Required` → "обязательный" (русский) / "required" (английский)
- `sl_ReadOnly` → "только для чтения" (русский) / "read-only" (английский)
- `sl_WriteOnly` → "только для записи" (русский) / "write-only" (английский)
- `sl_Deprecated` → "устарело" (русский) / "deprecated" (английский)

**Валидации:**
- `sl_AllowedValue` → "Допустимое значение" (русский) / "Allowed value" (английский)
- `sl_AllowedValues` → "Допустимые значения" (русский) / "Allowed values" (английский)
- `sl_Example` → "Пример" (русский) / "Example" (английский)
- `sl_Examples` → "Примеры" (русский) / "Examples" (английский)
- `sl_MultipleOf` → "Кратно" (русский) / "Multiple of" (английский)
- `sl_MatchPattern` → "Соответствует шаблону" (русский) / "Match pattern" (английский)
- `sl_Default` → "По умолчанию" (русский) / "Default" (английский)
- `sl_Style` → "Стиль" (русский) / "Style" (английский)

### Совместимость
- Версия библиотеки: `4.16.3`
- При обновлении библиотеки патч может потребовать обновления

## Создание новых патчей

Если нужно пропатчить другую библиотеку:

1. Внесите изменения в `node_modules/<библиотека>`
2. Создайте патч:
   ```bash
   npx patch-package <название-пакета>
   ```
3. Патч автоматически сохранится в `patches/`

## Примечания

- Патчи применяются только к скомпилированным файлам `.js` и `.mjs`
- Исходники TypeScript в `node_modules` не модифицируются
- Патчи включаются в итоговый бандл `web-components.min.js`
